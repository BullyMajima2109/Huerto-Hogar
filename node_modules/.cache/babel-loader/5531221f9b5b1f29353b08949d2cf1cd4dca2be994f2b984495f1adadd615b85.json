{"ast":null,"code":"import _objectSpread from\"C:/Users/jorda/OneDrive/Escritorio/William/huerto-hogar-react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// src/services/api.js\nconst API_BASE_URL=process.env.REACT_APP_API_URL||'http://localhost:8080/api';// Función para obtener el token del localStorage\nconst getToken=()=>{return localStorage.getItem('token');};// Función para obtener los headers con autenticación\nconst getAuthHeaders=()=>{const token=getToken();const headers={'Content-Type':'application/json'};if(token){headers['Authorization']=\"Bearer \".concat(token);}return headers;};// Función para hacer peticiones HTTP\nconst fetchAPI=async function(endpoint){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const url=\"\".concat(API_BASE_URL).concat(endpoint);const config=_objectSpread(_objectSpread({},options),{},{headers:_objectSpread(_objectSpread({},getAuthHeaders()),options.headers)});try{const response=await fetch(url,config);// Si la respuesta es 401, el token es inválido o expiró\nif(response.status===401){localStorage.removeItem('token');localStorage.removeItem('user');window.location.href='/login';throw new Error('Sesión expirada');}if(!response.ok){const errorData=await response.json().catch(()=>({message:'Error en la petición'}));throw new Error(errorData.message||\"Error \".concat(response.status));}// Si la respuesta está vacía, retornar null\nconst contentType=response.headers.get('content-type');if(contentType&&contentType.includes('application/json')){return await response.json();}return null;}catch(error){console.error('Error en API:',error);throw error;}};// API de Autenticación\nexport const authAPI={login:async(email,password)=>{return fetchAPI('/auth/login',{method:'POST',body:JSON.stringify({email,password})});},register:async userData=>{return fetchAPI('/auth/register',{method:'POST',body:JSON.stringify(userData)});}};// API de Productos\nexport const productosAPI={getAll:async()=>{return fetchAPI('/productos');},getById:async id=>{return fetchAPI(\"/productos/\".concat(id));},getByCategory:async category=>{return fetchAPI(\"/productos/categoria/\".concat(category));},create:async producto=>{return fetchAPI('/productos',{method:'POST',body:JSON.stringify(producto)});},update:async(id,producto)=>{return fetchAPI(\"/productos/\".concat(id),{method:'PUT',body:JSON.stringify(producto)});},delete:async id=>{return fetchAPI(\"/productos/\".concat(id),{method:'DELETE'});}};// API de Órdenes\nexport const ordenesAPI={getAll:async()=>{return fetchAPI('/ordenes');},getMisOrdenes:async()=>{return fetchAPI('/ordenes/mis-ordenes');},getById:async id=>{return fetchAPI(\"/ordenes/\".concat(id));},create:async items=>{return fetchAPI('/ordenes',{method:'POST',body:JSON.stringify(items)});},confirmar:async id=>{return fetchAPI(\"/ordenes/\".concat(id,\"/confirmar\"),{method:'POST'});},cancelar:async id=>{return fetchAPI(\"/ordenes/\".concat(id,\"/cancelar\"),{method:'POST'});}};export default fetchAPI;","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","getToken","localStorage","getItem","getAuthHeaders","token","headers","concat","fetchAPI","endpoint","options","arguments","length","undefined","url","config","_objectSpread","response","fetch","status","removeItem","window","location","href","Error","ok","errorData","json","catch","message","contentType","get","includes","error","console","authAPI","login","email","password","method","body","JSON","stringify","register","userData","productosAPI","getAll","getById","id","getByCategory","category","create","producto","update","delete","ordenesAPI","getMisOrdenes","items","confirmar","cancelar"],"sources":["C:/Users/jorda/OneDrive/Escritorio/William/huerto-hogar-react/src/services/api.js"],"sourcesContent":["// src/services/api.js\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8080/api';\r\n\r\n// Función para obtener el token del localStorage\r\nconst getToken = () => {\r\n  return localStorage.getItem('token');\r\n};\r\n\r\n// Función para obtener los headers con autenticación\r\nconst getAuthHeaders = () => {\r\n  const token = getToken();\r\n  const headers = {\r\n    'Content-Type': 'application/json',\r\n  };\r\n  if (token) {\r\n    headers['Authorization'] = `Bearer ${token}`;\r\n  }\r\n  return headers;\r\n};\r\n\r\n// Función para hacer peticiones HTTP\r\nconst fetchAPI = async (endpoint, options = {}) => {\r\n  const url = `${API_BASE_URL}${endpoint}`;\r\n  const config = {\r\n    ...options,\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n      ...options.headers,\r\n    },\r\n  };\r\n\r\n  try {\r\n    const response = await fetch(url, config);\r\n    \r\n    // Si la respuesta es 401, el token es inválido o expiró\r\n    if (response.status === 401) {\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('user');\r\n      window.location.href = '/login';\r\n      throw new Error('Sesión expirada');\r\n    }\r\n\r\n    if (!response.ok) {\r\n      const errorData = await response.json().catch(() => ({ message: 'Error en la petición' }));\r\n      throw new Error(errorData.message || `Error ${response.status}`);\r\n    }\r\n\r\n    // Si la respuesta está vacía, retornar null\r\n    const contentType = response.headers.get('content-type');\r\n    if (contentType && contentType.includes('application/json')) {\r\n      return await response.json();\r\n    }\r\n    return null;\r\n  } catch (error) {\r\n    console.error('Error en API:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// API de Autenticación\r\nexport const authAPI = {\r\n  login: async (email, password) => {\r\n    return fetchAPI('/auth/login', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n  },\r\n\r\n  register: async (userData) => {\r\n    return fetchAPI('/auth/register', {\r\n      method: 'POST',\r\n      body: JSON.stringify(userData),\r\n    });\r\n  },\r\n};\r\n\r\n// API de Productos\r\nexport const productosAPI = {\r\n  getAll: async () => {\r\n    return fetchAPI('/productos');\r\n  },\r\n\r\n  getById: async (id) => {\r\n    return fetchAPI(`/productos/${id}`);\r\n  },\r\n\r\n  getByCategory: async (category) => {\r\n    return fetchAPI(`/productos/categoria/${category}`);\r\n  },\r\n\r\n  create: async (producto) => {\r\n    return fetchAPI('/productos', {\r\n      method: 'POST',\r\n      body: JSON.stringify(producto),\r\n    });\r\n  },\r\n\r\n  update: async (id, producto) => {\r\n    return fetchAPI(`/productos/${id}`, {\r\n      method: 'PUT',\r\n      body: JSON.stringify(producto),\r\n    });\r\n  },\r\n\r\n  delete: async (id) => {\r\n    return fetchAPI(`/productos/${id}`, {\r\n      method: 'DELETE',\r\n    });\r\n  },\r\n};\r\n\r\n// API de Órdenes\r\nexport const ordenesAPI = {\r\n  getAll: async () => {\r\n    return fetchAPI('/ordenes');\r\n  },\r\n\r\n  getMisOrdenes: async () => {\r\n    return fetchAPI('/ordenes/mis-ordenes');\r\n  },\r\n\r\n  getById: async (id) => {\r\n    return fetchAPI(`/ordenes/${id}`);\r\n  },\r\n\r\n  create: async (items) => {\r\n    return fetchAPI('/ordenes', {\r\n      method: 'POST',\r\n      body: JSON.stringify(items),\r\n    });\r\n  },\r\n\r\n  confirmar: async (id) => {\r\n    return fetchAPI(`/ordenes/${id}/confirmar`, {\r\n      method: 'POST',\r\n    });\r\n  },\r\n\r\n  cancelar: async (id) => {\r\n    return fetchAPI(`/ordenes/${id}/cancelar`, {\r\n      method: 'POST',\r\n    });\r\n  },\r\n};\r\n\r\nexport default fetchAPI;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}